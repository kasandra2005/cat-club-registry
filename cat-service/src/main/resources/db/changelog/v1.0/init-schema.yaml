databaseChangeLog:
  - changeSet:
      id: 1
      author: dev
      runOnChange: true
      changes:
        - preConditions:
            - onFail: MARK_RAN
            - not:
                - tableExists:
                    tableName: cats
        - sql:
            sql: |
              CREATE TABLE cats (
                id BIGSERIAL PRIMARY KEY,
                name VARCHAR(100) NOT NULL,
                breed VARCHAR(50) NOT NULL,
                color VARCHAR(30) NOT NULL,
                gender VARCHAR(6) NOT NULL,
                birth_date DATE,
                owner_id BIGINT NOT NULL,
                mother_id BIGINT,
                father_id BIGINT,
                description VARCHAR(500),
                registration_date TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP
              )
        - createIndex:
            indexName: idx_cats_owner
            tableName: cats
            columns:
              - column:
                  name: owner_id
                  type: bigint
        - createIndex:
            indexName: idx_cats_parents
            tableName: cats
            columns:
              - column:
                  name: mother_id
                  type: bigint
              - column:
                  name: father_id
                  type: bigint
        - addForeignKeyConstraint:
            baseTableName: cats
            baseColumnNames: owner_id
            constraintName: fk_cat_owner
            referencedTableName: owners
            referencedColumnNames: id
            deferrable: false
            initiallyDeferred: false
        - addForeignKeyConstraint:
            baseTableName: cats
            baseColumnNames: mother_id
            constraintName: fk_cat_mother
            referencedTableName: cats
            referencedColumnNames: id
            deferrable: false
            initiallyDeferred: false
        - addForeignKeyConstraint:
            baseTableName: cats
            baseColumnNames: father_id
            constraintName: fk_cat_father
            referencedTableName: cats
            referencedColumnNames: id
            deferrable: false
            initiallyDeferred: false